<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Knowledge Univeral Link</title>
<style>
    /* --- Design Variables --- */
    :root { 
        --primary: #0ea5e9; 
        --bg: #0f172a; 
        --card: #1e293b; 
        --text: #f1f5f9; 
        --muted: #94a3b8; 
    }
    
    * { box-sizing: border-box; margin: 0; padding: 0; }

    body { 
        font-family: "Segoe UI", sans-serif; 
        background: var(--bg); 
        color: var(--text); 
        padding: 20px; 
        display: flex; 
        flex-direction: column; 
        align-items: center; 
        min-height: 100vh;
    }
    
    h1 { 
        background: linear-gradient(to right, var(--primary), #8b5cf6); 
        -webkit-background-clip: text; 
        -webkit-text-fill-color: transparent; 
        margin-bottom: 25px; 
        font-weight: 800; 
        font-size: 1.8rem;
        text-align: center; 
    }

    /* Tabs Container */
    .tabs { 
        display: flex; 
        gap: 8px; 
        margin-bottom: 25px; 
        flex-wrap: wrap; 
        justify-content: center; 
    }
    
    .btn { 
        background: rgba(255,255,255,0.05); 
        border: 1px solid rgba(255,255,255,0.1); 
        color: var(--muted); 
        padding: 8px 20px; 
        border-radius: 20px; 
        cursor: pointer; 
        transition: 0.2s; 
        font-weight: 600;
        font-size: 0.9rem;
    }
    
    .btn:hover, .btn.active { 
        background: var(--primary); 
        color: white; 
        border-color: var(--primary); 
        transform: translateY(-1px);
    }

    /* Content Area */
    #content-area { width: 100%; max-width: 800px; }
    
    details { 
        background: var(--card); 
        border: 1px solid rgba(255,255,255,0.1); 
        border-radius: 12px; 
        margin-bottom: 12px; 
        overflow: hidden; 
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1);
    }
    
    summary { 
        padding: 16px; 
        cursor: pointer; 
        font-weight: bold; 
        font-size: 1rem;
        background: rgba(255,255,255,0.02); 
        display: flex; 
        justify-content: space-between; 
        align-items: center; 
        list-style: none; 
        color: var(--primary);
    }
    
    summary::-webkit-details-marker { display: none; }
    summary::after { content: '+'; font-size: 1.2rem; font-weight: bold; }
    details[open] summary::after { content: '-'; }
    details[open] summary { border-bottom: 1px solid rgba(255,255,255,0.1); }

    /* Link Items */
    .link-list { display: flex; flex-direction: column; }
    
    .link-item { 
        display: flex; 
        align-items: flex-start; 
        gap: 15px; 
        padding: 16px; 
        border-bottom: 1px solid rgba(255,255,255,0.05); 
        text-decoration: none; 
        color: inherit; 
        transition: background 0.2s; 
    }
    
    .link-item:hover { background: rgba(255,255,255,0.05); }
    .link-item:last-child { border-bottom: none; }
    
    .link-icon { 
        width: 32px; 
        height: 32px; 
        border-radius: 6px; 
        margin-top: 2px; 
        background: #fff; /* White bg for transparent icons */
        object-fit: contain;
        padding: 2px;
    }
    
    .link-info { display: flex; flex-direction: column; gap: 4px; flex: 1; }
    
    .link-title { 
        font-size: 1rem; 
        font-weight: 500; 
        color: var(--text); 
        line-height: 1.4;
    }
    
    .link-url { 
        font-size: 0.8rem; 
        color: var(--muted); 
        word-break: break-all; 
        line-height: 1.3;
    }

    /* Loading & Error */
    #loading { margin-top: 50px; color: var(--primary); font-weight: bold; font-size: 1.1rem; text-align: center;}
    .error { color: #ef4444; text-align: center; margin-top: 20px; padding: 20px; border: 1px solid #ef4444; border-radius: 8px; background: rgba(239, 68, 68, 0.1); max-width: 600px;}

    .footer { margin-top: auto; padding-top: 40px; color: #64748b; font-size: 0.8rem; text-align: center; }
</style>
</head>
<body>

    <h1>üìö Knowledge Univeral Link</h1>
    <div id="loading">Connecting to Google Sheet...</div>
    <div id="error-msg" class="error" style="display:none;"></div>

    <div class="tabs" id="main-tabs"></div>
    <div id="content-area"></div>

    <div class="footer">Live Data from Google Sheets</div>

    <script>
        // ==========================================
        // üëá ·Ä°·ÄÖ·Ä∫·ÄÄ·Ä≠·ÄØ·Äï·Ä±·Ä∏·Äê·Ä≤·Ä∑ Link ·ÄÄ·Ä≠·ÄØ ·Äí·ÄÆ·Äô·Äæ·Ä¨ ·Äë·Ää·Ä∑·Ä∫·Äë·Ä¨·Ä∏·Äï·Ä´·Äê·Äö·Ä∫ üëá
        // ==========================================
        
        const CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTzZiVeEVnkYTU4TR2QQxNxOL6R-xEgrAloqMrJ0VtAuaXzu30qMLodfO33vON0r6gxIQ1CSpzUb5PB/pub?output=csv";
        
        // ==========================================

        let data = {};

        async function init() {
            try {
                // Fetch CSV Data
                const res = await fetch(CSV_URL);
                if(!res.ok) throw new Error("Google Sheet link not working (Check Internet or URL)");
                
                const text = await res.text();
                
                // HTML ·Äï·Äº·Äî·Ä∫·Äú·Ä¨·Äõ·ÄÑ·Ä∫ Link ·Äô·Äæ·Ä¨·Ä∏·Äî·Ä±·Äú·Ä≠·ÄØ·Ä∑ (Published as Webpage ·Äñ·Äº·ÄÖ·Ä∫·Äî·Ä±·Äú·Ä≠·ÄØ·Ä∑)
                if(text.includes("<!DOCTYPE html>")) {
                    throw new Error("Sheet Link ·Äô·Äæ·Ä¨·Ä∏·Äî·Ä±·Äï·Ä´·Äû·Ää·Ä∫·Åã 'Publish to web' ·Äú·ÄØ·Äï·Ä∫·ÄÅ·Äª·Ä≠·Äî·Ä∫·Äê·ÄΩ·ÄÑ·Ä∫ 'CSV' ·ÄÄ·Ä≠·ÄØ ·Äô·Äõ·ÄΩ·Ä±·Ä∏·ÄÅ·Äª·Äö·Ä∫·ÄÅ·Ä≤·Ä∑·Äï·ÄØ·Ä∂·Äõ·Äû·Ää·Ä∫·Åã");
                }

                parseCSV(text);
                
                document.getElementById('loading').style.display = 'none';
                renderMainTabs();

            } catch (e) {
                showError(e.message);
            }
        }

        function parseCSV(csvText) {
            const rows = csvText.split('\n');
            
            // Header (Row 1) ·ÄÄ·Ä≠·ÄØ ·ÄÄ·Äª·Ä±·Ä¨·Ä∫·Äï·Äº·ÄÆ·Ä∏ Row 2 ·ÄÄ ·ÄÖ·Äñ·Äê·Ä∫·Äô·Äö·Ä∫
            for(let i=1; i<rows.length; i++) {
                // CSV line parser (Handles quotes properly)
                const row = rows[i].trim();
                if(!row) continue;

                // Simple split by comma (assuming no commas in names for simplicity)
                // For better robustness with commas in titles, use Regex split:
                const cols = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/).map(c => c.replace(/^"|"$/g, '').trim());
                
                // Column Order Mapping:
                // Col 0: Main
                // Col 1: Sub
                // Col 2: Name
                // Col 3: Url
                const main = cols[0];
                const sub = cols[1];
                const name = cols[2];
                const url = cols[3];

                // Data ·Ä°·Äï·Äº·Ää·Ä∑·Ä∫·Ä°·ÄÖ·ÄØ·Ä∂·Äô·Äï·Ä´·Äõ·ÄÑ·Ä∫ ·ÄÄ·Äª·Ä±·Ä¨·Ä∫·Äô·Äö·Ä∫
                if(!main || !url) continue;

                if(!data[main]) data[main] = {};
                if(!data[main][sub]) data[main][sub] = [];

                data[main][sub].push({ name, url });
            }
        }

        function renderMainTabs() {
            const container = document.getElementById('main-tabs');
            const keys = Object.keys(data);
            
            if(keys.length === 0) {
                showError("Google Sheet ·Äë·Ä≤·Äê·ÄΩ·ÄÑ·Ä∫ Data ·Äô·Äê·ÄΩ·Ä±·Ä∑·Äï·Ä´·Åã (Main, Sub, Name, Url ·ÄÅ·Ä±·Ä´·ÄÑ·Ä∫·Ä∏·ÄÖ·Äâ·Ä∫·Äô·Äª·Ä¨·Ä∏ ·Äë·Ää·Ä∑·Ä∫·Äë·Ä¨·Ä∏·Äï·Ä´·Äû·Äú·Ä¨·Ä∏?)");
                return;
            }

            keys.forEach((cat, idx) => {
                const btn = document.createElement('button');
                btn.className = 'btn';
                btn.innerText = cat;
                btn.onclick = () => {
                    document.querySelectorAll('.btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    renderContent(cat);
                };
                container.appendChild(btn);
                if(idx===0) btn.click();
            });
        }

        function renderContent(main) {
            const container = document.getElementById('content-area');
            container.innerHTML = '';
            
            const subCats = data[main];
            Object.keys(subCats).forEach(sub => {
                const details = document.createElement('details');
                details.open = true; // Default open
                
                const summary = document.createElement('summary');
                summary.innerText = sub;
                details.appendChild(summary);

                const list = document.createElement('div');
                list.className = 'link-list';

                subCats[sub].forEach(link => {
                    // Auto Icon Fetcher
                    let domain = "";
                    try { domain = new URL(link.url).hostname; } catch(e){ domain = "google.com"; }
                    const icon = `https://www.google.com/s2/favicons?domain=${domain}&sz=64`;
                    
                    const a = document.createElement('a');
                    a.className = 'link-item';
                    a.href = link.url;
                    a.target = "_blank";
                    a.innerHTML = `
                        <img src="${icon}" class="link-icon" onerror="this.src='https://via.placeholder.com/32'">
                        <div class="link-info">
                            <span class="link-title">${link.name}</span>
                            <span class="link-url">${link.url}</span>
                        </div>
                    `;
                    list.appendChild(a);
                });

                details.appendChild(list);
                container.appendChild(details);
            });
        }

        function showError(msg) {
            document.getElementById('loading').style.display = 'none';
            const errDiv = document.getElementById('error-msg');
            errDiv.style.display = 'block';
            errDiv.innerText = "‚ùå Error: " + msg;
        }

        // Start
        init();
    </script>
</body>
</html>
